# This is a sample build configuration for Other.
# Check our guides at https://confluence.atlassian.com/x/5Q4SMw for more examples.
# Only use spaces to indent your .yml configuration.
# -----
# You can specify a custom docker image from Docker Hub as your build environment.
image: cmorgan2019/pod-test:0.4

clone:
  lfs: true

pipelines:
  default:
    - parallel:
        - step:
            name: Run Example 1
            script:
              - mkdir /root/pod
              - cp -r * /root/pod
              - cd /root/pod
              - ls
              - mkdir -p /data/acs/pod/examples
              - mkdir build
              - cd build
              - cmake ..
              - make >make.out 2>make.err
              - less make.err
              - python3 ../scripts/install_examples.py
              - cd /data/acs/pod/examples/ex1
              - find -type l -delete
              - chmod +x sh_ex1
              - ./sh_ex1 >make.out 2>make.err
              - cat make.out
              - cat make.err
              - cat pod.out
              - cat pod.rms
              - ls
              - cd solution
              - ls
              - cd ..
              - cp ../../scripts/test.py .
              - ls -la
              - python3 test.py
        - step:
            name: Run Example 2
            script:
              - mkdir -p /data/acs
              - ln -s /opt/atlassian/pipelines/agent/build/ /root/home/pod
              - cd /data/acs/pod
              - ls
              - mkdir build
              - cd build
              - cmake ..
              - make >make.out 2>make.err
              - less make.err
              - mkdir /data/acs/pod/examples
              - python3 ../scripts/install_examples.py
              - cd /data/acs/pod/examples/ex2
              - find -type l -delete
              - chmod +x sh_ex2
              - ./sh_ex1 >make.out 2>make.err
              - cat pod.out
              - cat pod.rms
              - python3 test.py
        - step:
            name: Run Example 3
            script:
              - mkdir /root/pod
              - cp -r * /root/pod
              - cd /root/pod
              - mkdir build
              - cd build
              - cmake ..
              - make >make.out 2>make.err
              - less make.err
              - python3 ../scripts/install_examples.py
              - cd ../examples/ex3
              - find -type l -delete
              - ./sh_ex3
              - cat pod.out
              - cat pod.rms
              - python3 test.py
        - step:
            name: Run Example 4
            script:
              - mkdir /root/pod
              - cp -r * /root/pod
              - cd /root/pod
              - mkdir build
              - cd build
              - cmake ..
              - make >make.out 2>make.err
              - less make.err
              - python3 ../scripts/install_examples.py
              - cd ../examples/ex4
              - find -type l -delete
              - ./sh_ex4
              - cat pod.out
              - cat pod.rms
              - python3 test.py
